---
layout: post
title: Run a Windows Service from Visual Studio [feedly]
date: '2013-07-16T21:48:00.001+01:00'
author: John Smith
tags:
modified_time: '2013-07-16T21:56:54.751+01:00'
blogger_id: tag:blogger.com,1999:blog-31446756.post-613218560524897702
blogger_orig_url: https://solrevdev.com/2013/07/run-windows-service-from-visual-studio.html
---

<div>      <style>  BODY  {  margin:1em;  font-size: 16px;  background-repeat: repeat;  line-height: 1.5em;  color: #262626;  }  a  {  color: #82BD1A;  }  table { font: inherit; }  .source {  color : #909090;  font-size : 14px;  }  .article  {  padding : 1em;  background-color: #eaeded;  color : #404040;  margin-top : 1.5em;  }  .visit  {  border-radius : 4px;  background-color: #CFCFCF;  text-align : center;  padding : 8px;  }  .visit a  {  text-decoration : none;  color : #666;  }  .header   {  padding-top : 0.3em;  padding-bottom : 1.5em;  font-size : 28px;  line-height : 1.2em;  font-weight : bold;  }  .footer   {  padding-top : 3em;  padding-bottom : 6em;  color : #444444;  text-align : center;  }  </style>      Windows based DevOps. Just the ticket. even though I use a mac we are essentially a windows shop so this is good stuff.<br>     <br>     <div class="article">  <div class="source">  Shared via <a href="http://bit.ly/SA6Efh">feedly</a> // published on DevOps On Windows // <a href="http://www.devopsonwindows.com/run-a-windows-service-from-visual-studio/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=run-a-windows-service-from-visual-studio">visit site</a>  </div>  <div class="header">  <b>Run a Windows Service from Visual Studio</b>  </div>  <div>  <p>This is part of a series on creating and installing Windows services.  </p><ol>  <li><a title="Create a Windows Service" href="http://www.devopsonwindows.com/create-a-windows-service/">How to Create a Windows Service</a>  </li><li><a title="Install a Windows Service" href="http://www.devopsonwindows.com/install-a-windows-service/">How to Install a Windows Service</a>  </li><li><strong>How to Run a Windows Service from Visual Studio</strong>  </li></ol>  <p>So far, we have learned how to <a title="Create a Windows Service" href="http://www.devopsonwindows.com/create-a-windows-service/">create</a> a basic shell for a Windows service and how to <a title="Install a Windows Service" href="http://www.devopsonwindows.com/install-a-windows-service/">install</a> it using both <code><a href="http://support.microsoft.com/kb/251192">sc</a></code> and <code><a href="http://msdn.microsoft.com/en-us/library/50614e95">InstallUtil</a></code>. Currently, the code for our simple demo service looks like this:  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/07/runFromConsoleStartPoint.png"><img width="391" alt="runFromConsoleStartPoint" src="http://www.devopsonwindows.com/wp-content/uploads/2013/07/runFromConsoleStartPoint.png" height="549"></a>  </p><p>As we saw in our <a title="Create a Windows Service" href="http://www.devopsonwindows.com/create-a-windows-service/">first episode</a>, if we simply run this application from Visual Studio (perhaps via the F5 key), we are met with this error message informing us that we cannot run the service from the command line or debugger:  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/06/NoServicesFromConsole.png"><img width="489" alt="NoServicesFromConsole" src="http://www.devopsonwindows.com/wp-content/uploads/2013/06/NoServicesFromConsole.png" height="199"></a>  </p><p>If we want to be able to efficiently develop our service from Visual Studio, it sure would be nice if we could actually run (and/or debug) it from Visual Studio. To begin, we need to abstract <code>MyService</code> away from the fact that is running via an implementation of <a href="http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.aspx"><code>ServiceBase</code></a>. To do so, we will create a new reusable implementation of <code>ServiceBase</code>, called <code>BasicService</code>:  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/07/BasicService.png"><img width="392" alt="BasicService" src="http://www.devopsonwindows.com/wp-content/uploads/2013/07/BasicService.png" height="408"></a>  </p><p>Note that <code>BasicService</code> overrides the two critical methods on <code>ServiceBase</code>, <a href="http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.onstart.aspx">OnStart</a> and <a href="http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.onstop.aspx">OnStop</a>, which are called when the service is commanded to start and stop by the service control manager. <code>BasicService</code> delegates those calls to a collaborating interface, <code>IService</code>. In order to convert our existing service to use this new infrastructure, we must change <code>MyService</code> to implement <code>IService</code>, and slightly modify our <code>Main</code> method:  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/07/useBasicService.png"><img width="469" alt="useBasicService" src="http://www.devopsonwindows.com/wp-content/uploads/2013/07/useBasicService.png" height="536"></a>  </p><p>Now that the "complex business logic" of our application (yes, I know it still doesn't do anything) is abstracted away from the fact that it will run via a service, we are free to run it another way. Utilizing <a href="http://msdn.microsoft.com/en-us/library/system.environment.userinteractive.aspx">Environment.UserInteractive</a>, we can modify the main method to turn our application into a hybrid console/service application:  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/07/runAsConsoleMainMethod.png"><img width="562" alt="runAsConsoleMainMethod" src="http://www.devopsonwindows.com/wp-content/uploads/2013/07/runAsConsoleMainMethod.png" height="346"></a>  </p><p>Running the application no longer throws up an error!  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/07/runAsConsoleInteractive.png"><img width="661" alt="runAsConsoleInteractive" src="http://www.devopsonwindows.com/wp-content/uploads/2013/07/runAsConsoleInteractive.png" height="143"></a>  </p><p>Since <a title="Install a Windows Service" href="http://www.devopsonwindows.com/install-a-windows-service/">I did promise</a> that we would have the service actually do something this time, let's build out <code>MyService</code> a bit:  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/07/serviceDoesSomething.png"><img width="413" alt="serviceDoesSomething" src="http://www.devopsonwindows.com/wp-content/uploads/2013/07/serviceDoesSomething.png" height="361"></a>  </p><p>The service will simply write a message to the console every second until we stop it. And because of our changes today, we can easily verify that by hitting F5:  </p><p><a href="http://www.devopsonwindows.com/wp-content/uploads/2013/07/serviceDoesSomethingConsole.png"><img width="677" alt="serviceDoesSomethingConsole" src="http://www.devopsonwindows.com/wp-content/uploads/2013/07/serviceDoesSomethingConsole.png" height="210"></a>  </p><p>Note that it is also possible to run the service by calling the executable from an interactive command line or by double-clicking it in Windows Explorer. These approaches also trigger the "run as a console app" branch in our main method. With just a little bit of additional code, we have made it much easier to develop and debug our service.  </p><p><a href="http://www.devopsonwindows.com/run-a-windows-service-from-visual-studio/">Run a Windows Service from Visual Studio</a> is a post from: <a href="http://www.devopsonwindows.com">DevOps On Windows - Be awesome at Windows DevOps or Windows Sysadmin</a>  </p><p>The post <a href="http://www.devopsonwindows.com/run-a-windows-service-from-visual-studio/">Run a Windows Service from Visual Studio</a> appeared first on <a href="http://www.devopsonwindows.com">DevOps On Windows</a>.  </p></div>  <br>  <div class="visit">  <a href="http://www.devopsonwindows.com/run-a-windows-service-from-visual-studio/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=run-a-windows-service-from-visual-studio">Visit website</a>  </div>  </div>  <div class="footer">  Sent via <a href="http://bit.ly/SA6Efh">feedly</a> // A news reader for creative minds.  </div>    </div>