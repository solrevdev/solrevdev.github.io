---
layout: post
title: My .NET ICache
date: '2010-08-24T19:28:00.001+01:00'
author: solrevdev
tags:
modified_time: '2010-08-24T19:28:35.023+01:00'
blogger_id: tag:blogger.com,1999:blog-31446756.post-4013649299167508565
blogger_orig_url: https://solrevdev.com/2010/08/my-net-icache_24.html
---

<div class='posterous_autopost'>       <p>.NET caching code used to help improve testability, swap out different implementations, and enhance the API.</p> <p></p> <p><a href="http://openmymind.net/2010/8/24/My-DOTNET-ICache">http://openmymind.net/2010/8/24/My-DOTNET-ICache#</a></p> <p></p> <p><div class="data type-csharp">  <table cellspacing="0" cellpadding="0"> <tr> <td> <pre class="line_numbers"><span rel="#L1" id="LID1">1</span> <span rel="#L2" id="LID2">2</span> <span rel="#L3" id="LID3">3</span> <span rel="#L4" id="LID4">4</span> <span rel="#L5" id="LID5">5</span> <span rel="#L6" id="LID6">6</span> <span rel="#L7" id="LID7">7</span> <span rel="#L8" id="LID8">8</span> <span rel="#L9" id="LID9">9</span> <span rel="#L10" id="LID10">10</span> <span rel="#L11" id="LID11">11</span> <span rel="#L12" id="LID12">12</span> <span rel="#L13" id="LID13">13</span> <span rel="#L14" id="LID14">14</span> <span rel="#L15" id="LID15">15</span> <span rel="#L16" id="LID16">16</span> <span rel="#L17" id="LID17">17</span> <span rel="#L18" id="LID18">18</span> <span rel="#L19" id="LID19">19</span> <span rel="#L20" id="LID20">20</span> <span rel="#L21" id="LID21">21</span> <span rel="#L22" id="LID22">22</span> <span rel="#L23" id="LID23">23</span> <span rel="#L24" id="LID24">24</span> <span rel="#L25" id="LID25">25</span> <span rel="#L26" id="LID26">26</span> <span rel="#L27" id="LID27">27</span> <span rel="#L28" id="LID28">28</span> <span rel="#L29" id="LID29">29</span> <span rel="#L30" id="LID30">30</span> <span rel="#L31" id="LID31">31</span> <span rel="#L32" id="LID32">32</span> <span rel="#L33" id="LID33">33</span> <span rel="#L34" id="LID34">34</span> <span rel="#L35" id="LID35">35</span> </pre> </td> <td width="100%">  <div class="highlight"><pre /><div class="line" id="LC1"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span></div><div class="line" id="LC2"><span class="k">using</span> <span class="nn">System.Web.Caching</span><span class="p">;</span></div><div class="line" id="LC3"><br /></div><div class="line" id="LC4"><span class="k">public</span> <span class="k">interface</span> <span class="n">ICache</span></div><div class="line" id="LC5"><span class="p">{</span></div><div class="line" id="LC6">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Get</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC7"><br /></div><div class="line" id="LC8">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC9">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC10">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC11">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC12">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC13">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="n">CacheItemPriority</span> <span class="n">priority</span><span class="p">,</span> <span class="n">CacheItemRemovedCallback</span> <span class="n">onRemoveCallback</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC14"><br /></div><div class="line" id="LC15">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsValue</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC16">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsValue</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC17">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsValue</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC18">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsValue</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC19">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsValue</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC20">&nbsp;&nbsp;&nbsp;&nbsp;<span class="n">T</span> <span class="n">Fetch</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="n">Action</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsValue</span><span class="p">,</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">callIfGetReturnsNull</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="n">CacheItemPriority</span> <span class="n">priority</span><span class="p">,</span> <span class="n">CacheItemRemovedCallback</span> <span class="n">onRemoveCallback</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC21"><br /></div><div class="line" id="LC22"><br /></div><div class="line" id="LC23">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">object</span> <span class="n">data</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC24">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">object</span> <span class="n">data</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC25">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">object</span> <span class="n">data</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC26">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">object</span> <span class="n">data</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC27">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">object</span> <span class="n">data</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC28">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="kt">object</span> <span class="n">data</span><span class="p">,</span> <span class="n">CacheDependency</span> <span class="n">dependencies</span><span class="p">,</span> <span class="n">DateTime</span> <span class="n">absoluteExpiration</span><span class="p">,</span> <span class="n">TimeSpan</span> <span class="n">slidingExpiration</span><span class="p">,</span> <span class="n">CacheItemPriority</span> <span class="n">priority</span><span class="p">,</span> <span class="n">CacheItemRemovedCallback</span> <span class="n">onRemoveCallback</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC29"><br /></div><div class="line" id="LC30">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">Remove</span><span class="p">(</span><span class="kt">string</span> <span class="n">key</span><span class="p">,</span> <span class="k">params</span> <span class="kt">object</span><span class="p">[]</span> <span class="n">keyArgs</span><span class="p">);</span></div><div class="line" id="LC31"><br /></div><div class="line" id="LC32">&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">void</span> <span class="nf">RemoveAll</span><span class="p">();</span></div><div class="line" id="LC33"><br /></div><div class="line" id="LC34">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kt">int</span> <span class="nf">Count</span><span class="p">();</span>        </div><div class="line" id="LC35"><span class="p">}</span></div></pre></div>  </td> </tr> </table>  </div></p>   <p style="font-size: 10px;"> <a href="http://posterous.com">Posted via email</a>  from <a href="http://solrev.posterous.com/my-net-icache">solution revolution</a> </p> </div>